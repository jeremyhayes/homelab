version: 1

metadata:
  name: App - whoami

entries:

  - model: authentik_providers_proxy.proxyprovider
    id: whoami
    identifiers:
      name: Provider for whoami
    attrs:
      authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
      invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
      external_host: https://whoami.lab.omglolwtfbbq.com
      mode: forward_single
      access_token_validity: "minutes=5"

  - model: authentik_core.application
    identifiers:
      slug: whoami
    attrs:
      name: whoami
      provider: !KeyOf whoami

  - model: authentik_outposts.outpost
    state: present
    identifiers:
      name: "authentik Embedded Outpost"
    attrs:
      providers:
        - !KeyOf whoami
