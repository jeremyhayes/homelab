version: '3.8'

services:

  mb8600-exporter:
    image: ghcr.io/jeremyhayes/motorola-mb8600-prometheus-exporter:main-c5d2f5e
    environment:
      - MODEM_BASE_URL=${MODEM_ADDRESS}
      - MODEM_USERNAME=${MODEM_USERNAME}
      - MODEM_PASSWORD=${MODEM_PASSWORD}
      - MODEM_IGNORE_SSL=true

  mb8600-restart:
    image: ghcr.io/jeremyhayes/motorola-mb8600-reboot:main-9d5bd5e
    command:
      - --url ${MODEM_ADDRESS}
      - --username ${MODEM_USERNAME}
      - --password ${MODEM_PASSWORD}
      - --ignore-ssl
    deploy:
      replicas: 0 # none by default; created when cron hits
      labels:
        - swarm.cronjob.enable=true
        - swarm.cronjob.schedule=0 5 * * mon
